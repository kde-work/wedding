<?phpadd_shortcode('wishlist', 'wb_wishlist_shortcode');function wb_wishlist_shortcode ($atts) {	if ( is_user_logged_in() ) {        wb_scripts__wishlist();        $user_id = wp_get_current_user()->ID;        $items = unserialize(base64_decode(get_user_meta($user_id, 'wl_save', 1)));        $params = shortcode_atts( array(            'title' => 'Email title',            'description' => 'Email description',            'placeholder' => 'Email placeholder',            'button' => 'send'        ), $atts );		ob_start();	    ?>		<div class="wishlist gl">            <div class="wb__loading"></div>			<div class="gl__guest-titel">Gjesteliste</div>			<div class="wb-search-input">				<input type="text" id="wb-search-input" autocomplete="off" class="wb-search__input" name="search-input" placeholder="Search for wish ...">			</div>            <form class="gl__form" data-max-id="<?php echo count($items); ?>">                <table class="gl__table guest-table gl__table--group gl__table--<?php //echo $group['term_id'] ?>">                    <tr class="gl__tr gl__tr--header">                        <th class="gl__th gl__th--status gl__w--70">Status</th>                        <th class="gl__th gl__th--name">Wishname</th>                        <th class="gl__th gl__th--link">Link or Location</th>                        <th class="gl__th gl__th--description">Description</th>                        <th class="gl__th gl__th--quantity">Quantity wanted</th>                        <th class="gl__th gl__th--price">Price</th>                        <th class="gl__th gl__th--notes gl__w--70 gl__ta--center">Notat</th>                        <th class="gl__th gl__th--option gl__w--60 gl__ta--right">Slett</th>                    </tr>                    <?php                    $i = 0;                    foreach ($items as $key => $val) {                        $i++;//                        print_r($val);                        echo wb_wishlist_item_template($i, $val);                    }                    echo wb_wishlist_item_template('empty_line', array());                    ?>                    <tr class="gl__tr wb-add-new">                        <td class="gl__td gl__td--status"></td>                        <td class="gl__td gl__td--add-elem">                            <input autocomplete="off" class="wb-add-new__input" type="text" title="Add new wish">                        </td>                        <td class="gl__td gl__td--add-elem" colspan="6">                            <div class="wb-add-new__button" data-group-id="">Legg til en ny gjest</div>                        </td>                    </tr>                </table>                <input type="hidden" name="action" value="wl_save">            </form>            <form class="wl-email-form">                <h3><?php echo $params['title'] ?></h3>                <p><?php echo $params['description'] ?></p>                <p>                    <input type="email" name="email" placeholder="<?php echo $params['placeholder'] ?>" class="wb-input" required>                    <input type="submit" class="">                </p>                <input type="hidden" name="action" value="wl_email">                <?php wp_nonce_field( 'wl_email_action', 'wl_email' ); ?>            </form>		<?php	}	return ob_get_clean();}function wb_wishlist_item_template($id, $item) {	ob_start();    ?>    <tr class="gl__item gl__item--<?php echo $id; ?>" data-id="<?php echo $id; ?>">        <td class="gl__td gl__td--status"><input type="checkbox" autocomplete="off" class="guest-table__input guest-table__input--status" name="status--<?php echo $id; ?>" title="status" <?php echo ($item['status'])?'checked':''; ?>><div class="gl__status" title="Gjestestatus Ventende/Deltar"></div></td>        <td class="gl__td gl__td--name"><input type="text" autocomplete="off" class="guest-table__input guest-table__input--name" name="name--<?php echo $id; ?>" title="Wish Name" placeholder="Gjestens Navn" value="<?php echo $item['name']; ?>"></td>        <td class="gl__td gl__td--link"><input type="text" autocomplete="off" class="guest-table__input guest-table__input--family" name="link--<?php echo $id; ?>" placeholder="Side av familie" value="<?php echo $item['link']; ?>"></td>        <td class="gl__td gl__td--description"><input type="text" autocomplete="off" class="guest-table__input guest-table__input--description" name="description--<?php echo $id; ?>" title="description" placeholder="Type rett" value="<?php echo $item['description']; ?>"></td>        <td class="gl__td gl__td--quantity"><input type="text" autocomplete="off" class="guest-table__input guest-table__input--quantity" name="quantity--<?php echo $id; ?>" title="quantity" placeholder="quantity" value="<?php echo $item['quantity']; ?>"></td>        <td class="gl__td gl__td--price"><input type="text" autocomplete="off" class="guest-table__input guest-table__input--price" name="price--<?php echo $id; ?>" title="price" placeholder="price" value="<?php echo $item['price']; ?>"></td>        <td class="gl__td gl__td--notes gl__ta--center gl-modal"><div class="gl-icon <?php echo (!$item['notes'])?'gl-icon--empty':''; ?> gl-icon--notes gl-modal__btn" data-target="notes" title="Contact Information in pop up"></div>            <div class="gl__modal gl__modal--notes">                <div class="gl-contact-modal">                    <div class="gl-contact-modal__header">                        <div class="gl-contact-modal__title">Notat på gjest</div>                    </div>                    <div class="gl-contact-modal__body">                        <table class="gl-contact-modal__table">                            <tr class="gl-contact-modal__phone">                                <td class="">                                    <textarea type="text" class="guest-table__input guest-table__textarea guest-table__input--notes" name="notes--<?php echo $id; ?>" placeholder="Notat på gjest" autocomplete="off"><?php echo $item['notes']; ?></textarea>                                </td>                            </tr>                        </table>                        <div class="wb-add-new__button gl__close-modal">Lukk og lagre</div>                    </div>                </div>                <div class="gl__overlay gl__close-modal"></div>            </div>        </td>        <td class="gl__td gl__td--option gl__ta--right"><div class="wb__delete" title="Remove line"></div></td>    </tr>    <?php	return ob_get_clean();}